
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ud1102/">
      
      
        <link rel="next" href="../ud11ac/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>11.3 Creació de serveis REST - Desarrollo Web en Entorno Servidor (DWES)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#creacion-de-servicios-rest" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Desarrollo Web en Entorno Servidor (DWES)" class="md-header__button md-logo" aria-label="Desarrollo Web en Entorno Servidor (DWES)" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Desarrollo Web en Entorno Servidor (DWES)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              11.3 Creació de serveis REST
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Canvia a mode oscur"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Canvia a mode oscur" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Canvia a mode normal"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Canvia a mode normal" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Desarrollo Web en Entorno Servidor (DWES)" class="md-nav__button md-logo" aria-label="Desarrollo Web en Entorno Servidor (DWES)" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    Desarrollo Web en Entorno Servidor (DWES)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bloc I - PHP
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Bloc I - PHP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 1 Arquitectura Web
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            UD 1 Arquitectura Web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud0101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1 Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud0102/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 Cliente/servidor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud0103/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Arquitectura de 3 capas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud0104/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4 MVC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud0105/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5 Decisiones de diseño
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud0106/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.6 Herramientas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud0107/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.7 Puesta en marcha
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud0108/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.8 Manual Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud01de/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descargas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud01ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actividades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud01/ud01re/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Referencias
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 2 Lenguaje PHP
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            UD 2 Lenguaje PHP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud02/ud0201/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud02/ud0202/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 PHP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud02/ud0203/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3 Operadores
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud02/ud0204/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4 Arrays
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud02/ud0205/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.5 Funciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud02/ud0206/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.6 Funciones predefinidas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud02/ud0207/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.7 Expresiones regulares
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud02/ud02ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actividades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud02/ud02re/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Referencias
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 3 PHP OO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            UD 3 PHP OO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0301/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0302/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2 Clases y objetos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0303/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3 Encapsulación
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0304/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.4 Constructor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0305/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.5 Clases estáticas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0306/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.6 Introspección
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0307/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.7 Herencia
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0308/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.8 Clases abstractas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0309/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.9 Clases final
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0310/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.10 Interfaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0311/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.11 Métodos encadenados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0312/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.12 Métodos mágicos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0313/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.13 Espacio de nombres
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0314/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.14 Gestión de errores
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0315/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.15 Excepciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud0316/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.16 SPL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud03ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actividades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud03/ud03re/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Referencias
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 4 Programación Web
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            UD 4 Programación Web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud04/ud0401/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud04/ud0402/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 Variable de servidor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud04/ud0403/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3 Formularios
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud04/ud0404/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4 Cabeceras de respuesta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud04/ud0405/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.5 Gestión de estado
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud04/ud0406/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.6 Autenticación de usuarios
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud04/ud04ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actividades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud04/ud04re/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Referencias
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 5 Acceso a Base de Datos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            UD 5 Acceso a Base de Datos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0501/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0502/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 Instalación
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0503/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3 Estructura de BD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0504/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4 Chollometro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0505/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.5 SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0506/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.6 phpMyAdmin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0507/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.7 MySQLi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0508/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.8 PHP Data Objects-PDO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0509/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.9 login & password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud0510/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.10 Acceso a ficheros
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud05ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actividades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud05/ud05re/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Referencias
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bloc II - Laravel
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Bloc II - Laravel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 6 Herramientas Web
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            UD 6 Herramientas Web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud06/ud0601/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud06/ud0602/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 Composer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud06/ud0603/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.3 Monolog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud06/ud0604/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.4 Documentación con phpDocumentor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud06/ud0605/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.5 Web Scraping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud06/ud0606/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.6 Pruebas con phpUnit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud06/ud06ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actividades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud06/ud06re/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Referencias
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 7 Framework
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            UD 7 Framework
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud07/ud0701/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1 Introducció
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud07/ud0702/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.2 Frameworks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud07/ud0703/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.3 Programari necessari
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud07/ud0704/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.4 Primeres passes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud07/ud0705/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.5 Rutes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud07/ud0706/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.6 Vistes amb Blade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud07/ud0707/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.7 Estils i Javascript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud07/ud07ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activitats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 8 Controladors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            UD 8 Controladors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud08/ud0801/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.1 Introducció
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud08/ud0802/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.2 Controladors i tipus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud08/ud0803/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.3 Injecció i dependències
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud08/ud08ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activitats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 9 Model de dades
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            UD 9 Model de dades
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud09/ud0901/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.1 Introducció
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud09/ud0902/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.2 Accés a base de dades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud09/ud0903/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.3 Migracions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud09/ud0904/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.4 Model de dades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud09/ud0905/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.5 Relacions entre models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud09/ud0906/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.6 Seeders i factories
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud09/ud0907/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9.7 Query Builder i ús de dades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud09/ud09ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activitats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 10 Formularis i validacions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            UD 10 Formularis i validacions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud10/ud1001/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.1 Introducció
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud10/ud1002/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.2 Definició de formularis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud10/ud1003/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10.3 Validació de dades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud10/ud10ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activitats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" checked>
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 11 Serveis REST
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            UD 11 Serveis REST
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ud1101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.1 Introducció
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ud1102/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.2 Concepte de servei REST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    11.3 Creació de serveis REST
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    11.3 Creació de serveis REST
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-definiendo-los-controladores-de-api" class="md-nav__link">
    <span class="md-ellipsis">
      1. Definiendo los controladores de API
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-estableciendo-las-rutas" class="md-nav__link">
    <span class="md-ellipsis">
      2. Estableciendo las rutas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-servicios-get" class="md-nav__link">
    <span class="md-ellipsis">
      3. Servicios GET
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Servicios GET">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-mas-sobre-el-formato-json-y-la-respuesta" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Más sobre el formato JSON y la respuesta
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-resto-de-servicios" class="md-nav__link">
    <span class="md-ellipsis">
      4. Resto de servicios
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Resto de servicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validacion-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Validación de datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#respuestas-de-error" class="md-nav__link">
    <span class="md-ellipsis">
      Respuestas de error
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ud11ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activitats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    UD 12 Autenticació d'usuaris
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            UD 12 Autenticació d'usuaris
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud12/ud1201/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12.1 Introducció
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud12/ud1202/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12.2 Autenticación basada en sesiones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud12/ud1203/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12.3 Autenticación basada en tokens
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ud12/ud12ac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activitats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bloc2re/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Referències
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-definiendo-los-controladores-de-api" class="md-nav__link">
    <span class="md-ellipsis">
      1. Definiendo los controladores de API
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-estableciendo-las-rutas" class="md-nav__link">
    <span class="md-ellipsis">
      2. Estableciendo las rutas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-servicios-get" class="md-nav__link">
    <span class="md-ellipsis">
      3. Servicios GET
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Servicios GET">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-mas-sobre-el-formato-json-y-la-respuesta" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Más sobre el formato JSON y la respuesta
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-resto-de-servicios" class="md-nav__link">
    <span class="md-ellipsis">
      4. Resto de servicios
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Resto de servicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validacion-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Validación de datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#respuestas-de-error" class="md-nav__link">
    <span class="md-ellipsis">
      Respuestas de error
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="creacion-de-servicios-rest">Creación de servicios REST</h1>
<p>Veamos ahora qué pasos dar para construir una API REST en Laravel que dé soporte a las operaciones básicas sobre una o varias entidades: consultas (GET), inserciones (POST), modificaciones (PUT) y borrados (DELETE). Emplearemos para ello los denominados controladores de API, que comentamos brevemente en unidades anteriores, al hablar de controladores, y que proporcionan un conjunto de funciones ya definidas para dar soporte a cada uno de estos comandos.</p>
<h2 id="1-definiendo-los-controladores-de-api">1. Definiendo los controladores de API</h2>
<p>Para proporcionar una API REST a los clientes que lo requieran, necesitamos definir un controlador (o controladores) orientados a ofrecer estos servicios REST. Estos controladores en Laravel se denominan de tipo <em>api</em>, como vimos en sesiones previas. Normalmente se definirá un controlador API por cada uno de los modelos a los que necesitemos acceder. Vamos a crear uno de prueba para ofrecer una API REST sobre los libros de nuestra aplicación de biblioteca.</p>
<p>Existen diferentes formas de ejecutar el comando de creación del controlador de API. Aquí vamos a mostrar quizá una de las más útiles:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="x">php artisan make:controller Api/LibroController --api --model=Libro</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="x">// ó, si no funciona:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="x">// sudo docker-compose exec myapp php artisan make:controller Api/LibroController --api --model=Libro</span>
</code></pre></div></td></tr></table></div>
<p>​   </p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span>
<span class="normal"><a href="#__codelineno-1-37">37</a></span>
<span class="normal"><a href="#__codelineno-1-38">38</a></span>
<span class="normal"><a href="#__codelineno-1-39">39</a></span>
<span class="normal"><a href="#__codelineno-1-40">40</a></span>
<span class="normal"><a href="#__codelineno-1-41">41</a></span>
<span class="normal"><a href="#__codelineno-1-42">42</a></span>
<span class="normal"><a href="#__codelineno-1-43">43</a></span>
<span class="normal"><a href="#__codelineno-1-44">44</a></span>
<span class="normal"><a href="#__codelineno-1-45">45</a></span>
<span class="normal"><a href="#__codelineno-1-46">46</a></span>
<span class="normal"><a href="#__codelineno-1-47">47</a></span>
<span class="normal"><a href="#__codelineno-1-48">48</a></span>
<span class="normal"><a href="#__codelineno-1-49">49</a></span>
<span class="normal"><a href="#__codelineno-1-50">50</a></span>
<span class="normal"><a href="#__codelineno-1-51">51</a></span>
<span class="normal"><a href="#__codelineno-1-52">52</a></span>
<span class="normal"><a href="#__codelineno-1-53">53</a></span>
<span class="normal"><a href="#__codelineno-1-54">54</a></span>
<span class="normal"><a href="#__codelineno-1-55">55</a></span>
<span class="normal"><a href="#__codelineno-1-56">56</a></span>
<span class="normal"><a href="#__codelineno-1-57">57</a></span>
<span class="normal"><a href="#__codelineno-1-58">58</a></span>
<span class="normal"><a href="#__codelineno-1-59">59</a></span>
<span class="normal"><a href="#__codelineno-1-60">60</a></span>
<span class="normal"><a href="#__codelineno-1-61">61</a></span>
<span class="normal"><a href="#__codelineno-1-62">62</a></span>
<span class="normal"><a href="#__codelineno-1-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="x">namespace App\Http\Controllers\Api;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="x">use App\Http\Controllers\Controller;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="x">use App\Models\Libro;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="x">use Illuminate\Http\Request;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="x">class LibroController extends Controller</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="x">{</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="x">  /**</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="x">   * Display a listing of the resource.</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="x">   *</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="x">   * @return \Illuminate\Http\Response</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="x">   */</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="x">  public function index()</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="x">  {</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="x">    //</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="x">  }</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="x">  /**</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="x">   * Store a newly created resource in storage.</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="x">   *</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="x">   * @param  \Illuminate\Http\Request  $request</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="x">   * @return \Illuminate\Http\Response</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="x">   */</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a><span class="x">  public function store(Request $request)</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="x">  {</span>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="x">    //</span>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a><span class="x">  }</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="x">  /**</span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a><span class="x">   * Display the specified resource.</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a><span class="x">   *</span>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a><span class="x">   * @param  \App\Models\Libro  $libro</span>
<a id="__codelineno-1-34" name="__codelineno-1-34"></a><span class="x">   * @return \Illuminate\Http\Response</span>
<a id="__codelineno-1-35" name="__codelineno-1-35"></a><span class="x">   */</span>
<a id="__codelineno-1-36" name="__codelineno-1-36"></a><span class="x">  public function show(Libro $libro)</span>
<a id="__codelineno-1-37" name="__codelineno-1-37"></a><span class="x">  {</span>
<a id="__codelineno-1-38" name="__codelineno-1-38"></a><span class="x">    //</span>
<a id="__codelineno-1-39" name="__codelineno-1-39"></a><span class="x">  }</span>
<a id="__codelineno-1-40" name="__codelineno-1-40"></a>
<a id="__codelineno-1-41" name="__codelineno-1-41"></a><span class="x">  /**</span>
<a id="__codelineno-1-42" name="__codelineno-1-42"></a><span class="x">   * Update the specified resource in storage.</span>
<a id="__codelineno-1-43" name="__codelineno-1-43"></a><span class="x">   *</span>
<a id="__codelineno-1-44" name="__codelineno-1-44"></a><span class="x">   * @param  \Illuminate\Http\Request  $request</span>
<a id="__codelineno-1-45" name="__codelineno-1-45"></a><span class="x">   * @param  \App\Models\Libro  $libro</span>
<a id="__codelineno-1-46" name="__codelineno-1-46"></a><span class="x">   * @return \Illuminate\Http\Response</span>
<a id="__codelineno-1-47" name="__codelineno-1-47"></a><span class="x">   */</span>
<a id="__codelineno-1-48" name="__codelineno-1-48"></a><span class="x">  public function update(Request $request, Libro $libro)</span>
<a id="__codelineno-1-49" name="__codelineno-1-49"></a><span class="x">  {</span>
<a id="__codelineno-1-50" name="__codelineno-1-50"></a><span class="x">    //</span>
<a id="__codelineno-1-51" name="__codelineno-1-51"></a><span class="x">  }</span>
<a id="__codelineno-1-52" name="__codelineno-1-52"></a>
<a id="__codelineno-1-53" name="__codelineno-1-53"></a><span class="x">  /**</span>
<a id="__codelineno-1-54" name="__codelineno-1-54"></a><span class="x">   * Remove the specified resource from storage.</span>
<a id="__codelineno-1-55" name="__codelineno-1-55"></a><span class="x">   *</span>
<a id="__codelineno-1-56" name="__codelineno-1-56"></a><span class="x">   * @param  \App\Models\Libro  $libro</span>
<a id="__codelineno-1-57" name="__codelineno-1-57"></a><span class="x">   * @return \Illuminate\Http\Response</span>
<a id="__codelineno-1-58" name="__codelineno-1-58"></a><span class="x">   */</span>
<a id="__codelineno-1-59" name="__codelineno-1-59"></a><span class="x">  public function destroy(Libro $libro)</span>
<a id="__codelineno-1-60" name="__codelineno-1-60"></a><span class="x">  {</span>
<a id="__codelineno-1-61" name="__codelineno-1-61"></a><span class="x">    //</span>
<a id="__codelineno-1-62" name="__codelineno-1-62"></a><span class="x">  }</span>
<a id="__codelineno-1-63" name="__codelineno-1-63"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>Observemos que se incorpora automáticamente la cláusula <code>use</code> para cargar el modelo asociado, que hemos indicado en el parámetro <code>--model</code>. Además, los métodos <code>show</code>, <code>update</code> y <code>destroy</code> ya vienen con un parámetro de tipo <code>Libro</code> que facilitará mucho algunas tareas.</p>
<div class="admonition note">
<p class="admonition-title"> </p>
<p>En el caso de versiones anteriores a Laravel 8, hay que tener en cuenta que, por defecto, los modelos se ubican en la carpeta <code>App</code>, por lo que deberemos indicar cualquier subcarpeta donde localizar el modelo cuando creemos el controlador, si es que lo hemos movido a una subcarpeta. Por ejemplo, <code>--model=Models/Libro</code>.</p>
</div>
<p>Cada una de las funciones del nuevo controlador creado se asocia a uno de los métodos REST comentados anteriormente:</p>
<ul>
<li><strong><code>index</code></strong> se asociaría con una operación GET de listado general, para obtener todos los registros (de libros, en este caso)</li>
<li><strong><code>store</code></strong> se asociaría con una operación POST, para almacenar los datos que lleguen en la petición (como un nuevo libro, en nuestro caso)</li>
<li><strong><code>show</code></strong> se asociaría con una operación GET para obtener el registro asociado a un identificador concreto</li>
<li><strong><code>update</code></strong> se asociaría con una operación PUT, para actualizar los datos del registro asociado a un identificador concreto</li>
<li><strong><code>destroy</code></strong> se asociaría con una operación DELETE, para eliminar los datos del registro asociado a un identificador concreto</li>
</ul>
<h2 id="2-estableciendo-las-rutas">2. Estableciendo las rutas</h2>
<p>Una vez tenemos el controlador API creado, vamos a definir las rutas asociadas a cada método del controlador. Si recordamos de sesiones anteriores, podíamos emplear el método <code>Route::resource</code> en el archivo <code>routes/web.php</code> para establecer de golpe todas las rutas asociadas a un controlador de recursos. De forma análoga, podemos emplear el método <code>Route::apiResource</code> en el archivo <code>routes/api.php</code> para establecer automáticamente todas las rutas de un controlador de API. Añadimos esta línea en dicho archivo <code>routes/api.php</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="x">use App\Http\Controllers\Api\LibroController;</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="x">// ...</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="x">Route::apiResource(&#39;libros&#39;, LibroController::class);</span>
</code></pre></div></td></tr></table></div>
<p>Las rutas de API (aquellas definidas en el archivo <code>routes/api.php</code>) por defecto tienen un prefijo <code>api</code>, tal y como se establece en el <em>provider</em> <code>RouteServiceProvider</code>. Por tanto, hemos definido una ruta general <code>api/libros</code>, de forma que todas las subrutas que se deriven de ella llevarán a uno u otro método del controlador de API de libros.</p>
<p>Podemos comprobar <strong>qué rutas hay activas</strong> con este comando:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="x">php artisan route:list</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="x">// ó, si no funciona:</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="x">// sudo docker-compose exec myapp php artisan route:list</span>
</code></pre></div></td></tr></table></div>
<p>Veremos, entre otras, las 5 rutas derivadas del controlador API de libros:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span>
<span class="normal"><a href="#__codelineno-4-7">7</a></span>
<span class="normal"><a href="#__codelineno-4-8">8</a></span>
<span class="normal"><a href="#__codelineno-4-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>+----------------------------------------------------+
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="p">|</span>Method<span class="w">     </span><span class="p">|</span><span class="w"> </span>URI<span class="w">                   </span><span class="p">|</span><span class="w"> </span>Name<span class="w">           </span><span class="p">|</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>+----------------------------------------------------+
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="p">|</span><span class="w"> </span>GET<span class="p">|</span>HEAD<span class="w">  </span><span class="p">|</span><span class="w"> </span>api/libros<span class="w">            </span><span class="p">|</span><span class="w"> </span>libros.index<span class="w">   </span><span class="p">|</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="p">|</span><span class="w"> </span>POST<span class="w">      </span><span class="p">|</span><span class="w"> </span>api/libros<span class="w">            </span><span class="p">|</span><span class="w"> </span>libros.store<span class="w">   </span><span class="p">|</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="p">|</span><span class="w"> </span>GET<span class="p">|</span>HEAD<span class="w">  </span><span class="p">|</span><span class="w"> </span>api/libros/<span class="o">{</span>libro<span class="o">}</span><span class="w">    </span><span class="p">|</span><span class="w"> </span>libros.show<span class="w">    </span><span class="p">|</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="p">|</span><span class="w"> </span>PUT<span class="p">|</span>PATCH<span class="w"> </span><span class="p">|</span><span class="w"> </span>api/libros/<span class="o">{</span>libro<span class="o">}</span><span class="w">    </span><span class="p">|</span><span class="w"> </span>libros.update<span class="w">  </span><span class="p">|</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="p">|</span><span class="w"> </span>DELETE<span class="w">    </span><span class="p">|</span><span class="w"> </span>api/libros/<span class="o">{</span>libro<span class="o">}</span><span class="w">    </span><span class="p">|</span><span class="w"> </span>libros.destroy<span class="w"> </span><span class="p">|</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>+----------------------------------------------------+
</code></pre></div></td></tr></table></div>
<h2 id="3-servicios-get">3. Servicios GET</h2>
<p>Vamos a empezar por definir el método <code>index</code>. En este caso, vamos a obtener el conjunto de libros de la base de datos y devolverlo tal cual:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="x">public function index()</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="x">{</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="x">  $libros = Libro::get();</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="x">  return $libros;</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>Si accedemos a la ruta <code>api/libros</code> desde el navegador, se activará el método <code>index</code> que acabamos de implementar, y recibiremos los libros de la base de datos, directamente en formato JSON.</p>
<div style="text-align: center;"><img src="../../img/ud11/get_json.png" alt="get json" style="max-width: 70%;" /></div>

<div class="admonition note">
<p class="admonition-title"> </p>
<p>Podemos instalar la extensión <a href="https://chrome.google.com/webstore/detail/json-formatter/bcjindcccaagfpapjjmafapmmgkkhgoa?hl=es" target="_blank">JSON formatter</a> para Chrome, y así poder ver los datos en formato JSON más organizados y con la sintaxis resaltada, como en la imagen anterior.</p>
</div>
<p>De una forma similar, podríamos implementar y probar el método <code>show</code>, para mostrar los datos de un libro en particular:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="x">public function show(Libro $libro)</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="x">{</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="x">  return $libro;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>En este caso, si accedemos a la URI <code>api/libros/1</code>, obtendremos la información del libro con <em>id</em> = 1. Notar que Laravel se encarga automáticamente de buscar el libro por nosotros (hacer la correspondiente operación <code>find</code> para el <em>id</em> proporcionado). Es lo que se conoce como <em>enlace implícito</em>, y es algo que también está disponible en los controladores web normales, siempre que los asociemos correctamente con el modelo vinculado. Esto se hace automáticamente si creamos el controlador junto con el modelo, como vimos en la unidad 4, o si usamos el parámetro <code>--model</code> para asociarlo, como hemos hecho aquí.</p>
<h3 id="31-mas-sobre-el-formato-json-y-la-respuesta">3.1. Más sobre el formato JSON y la respuesta</h3>
<p>Tras probar los dos servicios anteriores, habrás observado que Laravel se encarga de transformar directamente los registros obtenidos a formato JSON cuando los enviamos mediante <code>return</code>, por lo que, en principio, no tenemos por qué preocuparnos de este proceso. Sin embargo, de este modo se escapan algunas cosas a nuestro control. Por ejemplo, y sobre todo, no podemos especificar el código de estado de la respuesta, que por defecto es 200 si todo ha ido correctamente. Además, tampoco podemos controlar qué información enviar del objeto en cuestión.</p>
<p>Si queremos limitar o formatear la información a enviar de los objetos que estamos tratando, y que no se envíen todos sus campos sin más, tenemos varias opciones:</p>
<ul>
<li>Añadir cláusulas <code>hidden</code> en los modelos correspondientes, para indicar que esa información no debe ser enviada en ningún caso en ninguna parte de la aplicación. Es lo que ocurre, por ejemplo, con el campo <em>password</em> del modelo de <code>Usuario</code>:</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="x">protected $hidden = [&#39;password&#39;];</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>Definir a mano un array con los campos a enviar en el método del controlador. En el caso de la ficha del libro anterior, si sólo queremos enviar el título y la editorial, podríamos hacer algo así:</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="x">public function show(Libro $libro)</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="x">{</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="x">  return [</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="x">     &#39;titulo&#39;    =&gt; $libro-&gt;titulo,</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="x">     &#39;editorial&#39; =&gt; $libro-&gt;editorial</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="x">  ];</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>En el caso de que el paso anterior sea muy costoso (porque el modelo tenga muchos campos, o porque tengamos que hacer lo mismo en varias partes del código), también podemos definir recursos (<em>resources</em>), que permiten separar el código de la información a mostrar del propio controlador. <a href="https://laravel.com/docs/eloquent-resources">Aquí</a> podéis encontrar información al respecto, ya que estos contenidos escapan del alcance de esta sesión.</li>
</ul>
<p>Por otra parte, si queremos añadir o modificar más información en la respuesta, como el código de estado, la estructura anterior no nos sirve, ya que siempre se va a enviar un código 200. Para esto, es conveniente emplear el método <code>response()-&gt;json(...)</code>, que permite especificar como primer parámetro los datos a enviar, y como segundo parámetro el código de estado. Los métodos anteriores quedarían así, enviando un código 200 como respuesta (aunque si se omite el segundo parámetro, se asume que es 200):</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="x">public function index()</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="x">{</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="x">  $libros = Libro::get();</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="x">  return response()-&gt;json($libros, 200);;</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="x">}</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="x">// ...</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="x">public function show(Libro $libro)</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="x">{</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="x">  return response()-&gt;json($libro, 200);</span>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<h2 id="4-resto-de-servicios">4. Resto de servicios</h2>
<p>Veamos ahora cómo implementar el resto de servicios (POST, PUT y DELETE). En el caso de la inserción (<strong>POST</strong>), deberemos recibir en la petición los datos del objeto a insertar (un libro, en nuestro ejemplo). Igual que los datos del servidor al cliente se envían en formato JSON, es de esperar en aplicaciones que siguen la arquitectura REST que los datos del cliente al servidor también se envíen en formato JSON.</p>
<p>Nuestro método <code>store</code>, asociado al servicio POST, podría quedar de este modo (devolvemos el código de estado 201, que se utiliza cuando se han insertado elementos nuevos):</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="x">public function store(Request $request)</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="x">{</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="x">  $libro = new Libro();</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="x">  $libro-&gt;titulo = $request-&gt;titulo;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="x">  $libro-&gt;editorial = $request-&gt;editorial;</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="x">  $libro-&gt;precio = $request-&gt;precio;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="x">  $libro-&gt;autor()-&gt;associate(Autor::findOrFail($request-&gt;autor_id));</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="x">  $libro-&gt;save();</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="x">  return response()-&gt;json($libro, 201);</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>De forma similar implementaríamos el servicio <strong>PUT</strong>, a través del método <code>update</code>. En este caso devolvemos un código de estado 200:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="x">public function update(Request $request, Libro $libro)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="x">{</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="x">  $libro-&gt;titulo = $request-&gt;titulo;</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="x">  $libro-&gt;editorial = $request-&gt;editorial;</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="x">  $libro-&gt;precio = $request-&gt;precio;</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="x">  $libro-&gt;autor()-&gt;associate(Autor::findOrFail($request-&gt;autor_id));</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="x">  $libro-&gt;save();</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="x">  return response()-&gt;json($libro);</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>Finalmente, para el servicio <strong>DELETE</strong>, debemos implementar el método <code>destroy</code>, que podría quedar así:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="x">public function destroy(Libro $libro)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="x">{</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="x">  $libro-&gt;delete();</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="x">  return response()-&gt;json(null, 204);</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>Notar que devolvemos un código de estado 204, que indica que no estamos devolviendo contenido (es <em>null</em>). Por otra parte, es habitual en este tipo de operaciones de borrado devolver en formato JSON el objeto que se ha eliminado, por si acaso se quiere deshacer la operación en un paso posterior. En este caso, el código del método de borrado sería así:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="x">public function destroy(Libro $libro)</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="x">{</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="x">  $libro-&gt;delete();</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="x">  return response()-&gt;json($libro);</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>Como podemos empezar a intuir, probar estos servicios no es tan sencillo como probar servicios de tipo GET, ya que no podemos simplemente teclear una URL en el navegador. Necesitamos un mecanismo para pasarle los datos al servidor en formato JSON, y también el método (POST, PUT o DELETE). Veremos cómo en la siguiente sección.</p>
<h3 id="validacion-de-datos">Validación de datos</h3>
<p>A la hora de recibir datos en formato JSON para servicios REST, también podemos establecer mecanismos de <strong>validación</strong> similares a los vistos para los formularios, a través de los correspondientes <em>requests</em>. De hecho, en el caso de la biblioteca podemos emplear la clase <code>App\Http\Requests\LibroPost</code> que hicimos en sesiones anteriores, para validar que los datos que llegan tanto a <code>store</code> como a <code>update</code> son correctos. Basta con usar un parámetro de este tipo en estos métodos, en lugar del parámetro <code>Request</code> que viene por defecto:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span>
<span class="normal"><a href="#__codelineno-14-5">5</a></span>
<span class="normal"><a href="#__codelineno-14-6">6</a></span>
<span class="normal"><a href="#__codelineno-14-7">7</a></span>
<span class="normal"><a href="#__codelineno-14-8">8</a></span>
<span class="normal"><a href="#__codelineno-14-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="x">public function store(LibroPost $request)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="x">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="x">  // ...</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="x">}</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="x">...</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="x">public function update(LibroPost $request, Libro $libro)</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="x">{</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="x">  // ...</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="respuestas-de-error">Respuestas de error</h3>
<p>Por otra parte, debemos asegurarnos de que cualquier error que se produzca en la parte de la API devuelva un cotenido en formato JSON, y no una página web. Por ejemplo, si solicitamos ver la ficha de un libro cuyo <em>id</em> no existe, no debería devolvernos una página de error 404, sino un código de estado 404 con un mensaje de error en formato JSON.</p>
<p>Esto no se cumple por defecto, ya que Laravel está configurado para renderizar una vista con el error producido. Para modificar este comportamiento en <strong>versiones anteriores a Laravel 8</strong>, debemos editar el archivo <code>App\Exceptions\Handler.php</code>, en concreto su método <code>render</code>, y hacer algo así:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span>
<span class="normal"><a href="#__codelineno-15-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="x">public function render($request, Throwable $exception)</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="x">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="x">  if ($request-&gt;is(&#39;api*&#39;))</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="x">  {</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="x">    if ($exception instanceof ModelNotFoundException)</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="x">      return response()-&gt;json([&#39;error&#39; =&gt; &#39;Elemento no encontrado&#39;], 404);</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="x">    else if ($exception instanceof ValidationException)</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="x">      return response()-&gt;json([&#39;error&#39; =&gt; &#39;Datos no válidos&#39;], 400);</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="x">    else if (isset($exception))</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="x">      return response()-&gt;json([&#39;error&#39; =&gt; &#39;Error en la aplicación: &#39; . </span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="x">                $exception-&gt;getMessage()], 500);</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="x">  }</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="x">  // Esta es la única instrucción que hay en la versión original</span>
<a id="__codelineno-15-15" name="__codelineno-15-15"></a><span class="x">  return parent::render($request, $exception);</span>
<a id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<p>Hemos añadido sobre el código original una cláusula <code>if</code> que se centra en las peticiones de tipo <code>api</code>. En este caso, podemos distinguir los distintos tipos de excepciones que se producen. Para nuestro ejemplo distinguimos tres: errores de tipo 404, errores de validación u otros errores. En todos los casos se devuelve un contenido JSON con el código de estado y campos adecuados. Si todo es correcto y no hay errores, o si no estamos en rutas <em>api</em>, el comportamiento será el habitual.</p>
<p>En el caso de <strong>Laravel 8 y posteriores</strong>, el método a modificar se llama <code>register</code>, dentro de la misma clase <code>App\Exceptions\Handler.php</code>. Lo podemos dejar de este modo para hacer algo equivalente a lo anterior:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="x">public function register()</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="x">{</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="x">  $this-&gt;renderable(function (Throwable $exception) {</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="x">     if (request()-&gt;is(&#39;api*&#39;))</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="x">     {</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="x">        if ($exception instanceof ModelNotFoundException)</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="x">            return response()-&gt;json([&#39;error&#39; =&gt; &#39;Recurso no encontrado&#39;], 404);</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="x">        else if ($exception instanceof ValidationException)</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="x">            return response()-&gt;json([&#39;error&#39; =&gt; &#39;Datos no válidos&#39;], 400);</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="x">        else if (isset($exception))</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="x">            return response()-&gt;json([&#39;error&#39; =&gt; &#39;Error: &#39; . </span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="x">                    $exception-&gt;getMessage()], 500);</span>
<a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="x">     }</span>
<a id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="x">  });</span>
<a id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="x">}</span>
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title"> </p>
<p>Relacionado con el código anterior, las excepciones que se identifican están en <code>Illuminate\Database\Eloquent\ModelNotFoundException</code> e <code>Illuminate\Validation\ValidationException</code>, respectivamente.</p>
</div>
<p>En algunas versiones de Laravel, la clase base <code>ExceptionHandler</code> realiza algunas conversiones de tipos de excepciones. Así, por ejemplo, la excepción <code>ModelNotFoundException</code> se convierte a <code>NotFoundHttpException</code>. En este caso, el <code>if</code> anterior que detecta la excepción podría no funcionar, ya que el operador <code>instanceof</code> está buscando la excepción equivocada. Una forma algo más completa de detectar si no se encuentra el recurso solicitado sería esta (incluimos las cláusulas <code>using</code> correspondientes también):</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">PHP</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span>
<span class="normal"><a href="#__codelineno-17-15">15</a></span>
<span class="normal"><a href="#__codelineno-17-16">16</a></span>
<span class="normal"><a href="#__codelineno-17-17">17</a></span>
<span class="normal"><a href="#__codelineno-17-18">18</a></span>
<span class="normal"><a href="#__codelineno-17-19">19</a></span>
<span class="normal"><a href="#__codelineno-17-20">20</a></span>
<span class="normal"><a href="#__codelineno-17-21">21</a></span>
<span class="normal"><a href="#__codelineno-17-22">22</a></span>
<span class="normal"><a href="#__codelineno-17-23">23</a></span>
<span class="normal"><a href="#__codelineno-17-24">24</a></span>
<span class="normal"><a href="#__codelineno-17-25">25</a></span>
<span class="normal"><a href="#__codelineno-17-26">26</a></span>
<span class="normal"><a href="#__codelineno-17-27">27</a></span>
<span class="normal"><a href="#__codelineno-17-28">28</a></span>
<span class="normal"><a href="#__codelineno-17-29">29</a></span>
<span class="normal"><a href="#__codelineno-17-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="x">namespace App\Exceptions;</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="x">use Illuminate\Foundation\Exceptions\Handler as ExceptionHandler;</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="x">use Symfony\Component\HttpKernel\Exception\NotFoundHttpException;</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="x">use Illuminate\Validation\ValidationException;</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="x">use Illuminate\Database\Eloquent\ModelNotFoundException;</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="x">use Throwable;</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="x">class Handler extends ExceptionHandler</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="x">{</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="x">  // ...</span>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a>
<a id="__codelineno-17-13" name="__codelineno-17-13"></a><span class="x">  public function register()</span>
<a id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="x">  {</span>
<a id="__codelineno-17-15" name="__codelineno-17-15"></a><span class="x">    $this-&gt;renderable(function (Throwable $exception) {</span>
<a id="__codelineno-17-16" name="__codelineno-17-16"></a><span class="x">       if (request()-&gt;is(&#39;api*&#39;))</span>
<a id="__codelineno-17-17" name="__codelineno-17-17"></a><span class="x">       {</span>
<a id="__codelineno-17-18" name="__codelineno-17-18"></a><span class="x">          if ($exception instanceof ModelNotFoundException ||</span>
<a id="__codelineno-17-19" name="__codelineno-17-19"></a><span class="x">             ($exception instanceof NotFoundHttpException &amp;&amp; </span>
<a id="__codelineno-17-20" name="__codelineno-17-20"></a><span class="x">               $exception-&gt;getPrevious() &amp;&amp;</span>
<a id="__codelineno-17-21" name="__codelineno-17-21"></a><span class="x">               $exception-&gt;getPrevious() instanceof ModelNotFoundException))</span>
<a id="__codelineno-17-22" name="__codelineno-17-22"></a><span class="x">            return response()-&gt;json([&#39;error&#39; =&gt; &#39;Recurso no encontrado&#39;], 404);</span>
<a id="__codelineno-17-23" name="__codelineno-17-23"></a><span class="x">          else if ($exception instanceof ValidationException)</span>
<a id="__codelineno-17-24" name="__codelineno-17-24"></a><span class="x">            return response()-&gt;json([&#39;error&#39; =&gt; &#39;Datos no válidos&#39;], 400);</span>
<a id="__codelineno-17-25" name="__codelineno-17-25"></a><span class="x">          else if (isset($exception))</span>
<a id="__codelineno-17-26" name="__codelineno-17-26"></a><span class="x">            return response()-&gt;json([&#39;error&#39; =&gt; &#39;Error: &#39; .</span>
<a id="__codelineno-17-27" name="__codelineno-17-27"></a><span class="x">                        $exception-&gt;getMessage()], 500);</span>
<a id="__codelineno-17-28" name="__codelineno-17-28"></a><span class="x">       }</span>
<a id="__codelineno-17-29" name="__codelineno-17-29"></a><span class="x">    });</span>
<a id="__codelineno-17-30" name="__codelineno-17-30"></a><span class="x">  }</span>
</code></pre></div></td></tr></table></div>
<p>De este modo, detectamos tanto si es una <code>ModelNotFoundException</code> original como si ha sido convertida a <code>NotFoundHttpException</code>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../ud1102/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 11.2 Concepte de servei REST">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                11.2 Concepte de servei REST
              </div>
            </div>
          </a>
        
        
          
          <a href="../ud11ac/" class="md-footer__link md-footer__link--next" aria-label="Next: Activitats">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Activitats
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
<!--     Made with -->IES
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      <!--Material for MkDocs-->
      Mestre Ramon Esteve
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "navigation.footer", "navigation.top"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>